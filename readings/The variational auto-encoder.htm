<!DOCTYPE html>
<!-- saved from url=(0052)https://ermongroup.github.io/cs228-notes/extras/vae/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>The variational auto-encoder</title>
  <meta name="description" content="Lecture notes for Stanford cs228.">

  <link rel="stylesheet" href="./The variational auto-encoder_files/tufte.css">

  <!-- Google Fonts loaded here depending on setting in _data/options.yml true loads font, blank does not--><link href="./The variational auto-encoder_files/css" rel="stylesheet" type="text/css"><!-- Load up MathJax script if needed ... specify in /_data/options.yml file--><script async="" src="./The variational auto-encoder_files/analytics.js"></script><script type="text/javascript" src="./The variational auto-encoder_files/latest.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75587219-1', 'auto');
  ga('send', 'pageview');
  </script>

  <link rel="canonical" href="https://ermongroup.github.io/cs228-notes/extras/vae/">
  <link rel="alternate" type="application/rss+xml" title="Probabilistic graphical modeling course" href="https://ermongroup.github.io/cs228-notes/feed.xml">
<script data-dapp-detection="">
(function() {
  let alreadyInsertedMetaTag = false

  function __insertDappDetected() {
    if (!alreadyInsertedMetaTag) {
      const meta = document.createElement('meta')
      meta.name = 'dapp-detected'
      document.head.appendChild(meta)
      alreadyInsertedMetaTag = true
    }
  }

  if (window.hasOwnProperty('web3')) {
    // Note a closure can't be used for this var because some sites like
    // www.wnyc.org do a second script execution via eval for some reason.
    window.__disableDappDetectionInsertion = true
    // Likely oldWeb3 is undefined and it has a property only because
    // we defined it. Some sites like wnyc.org are evaling all scripts
    // that exist again, so this is protection against multiple calls.
    if (window.web3 === undefined) {
      return
    }
    __insertDappDetected()
  } else {
    var oldWeb3 = window.web3
    Object.defineProperty(window, 'web3', {
      configurable: true,
      set: function (val) {
        if (!window.__disableDappDetectionInsertion)
          __insertDappDetected()
        oldWeb3 = val
      },
      get: function () {
        if (!window.__disableDappDetectionInsertion)
          __insertDappDetected()
        return oldWeb3
      }
    })
  }
})()</script><script type="text/javascript" async="" src="./The variational auto-encoder_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-test.mjx-test-display {display: table!important}
.mjx-test.mjx-test-inline {display: inline!important; margin-right: -1px}
.mjx-test.mjx-test-default {display: block!important; clear: both}
.mjx-ex-box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.mjx-test-inline .mjx-left-box {display: inline-block; width: 0; float: left}
.mjx-test-inline .mjx-right-box {display: inline-block; width: 0; float: right}
.mjx-test-display .mjx-right-box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
.MJXc-TeX-vec-R {font-family: MJXc-TeX-vec-R,MJXc-TeX-vec-Rw}
.MJXc-TeX-vec-B {font-family: MJXc-TeX-vec-B,MJXc-TeX-vec-Bx,MJXc-TeX-vec-Bw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-R; src: local('MathJax_Vector'), local('MathJax_Vector-Regular')}
@font-face {font-family: MJXc-TeX-vec-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-B; src: local('MathJax_Vector Bold'), local('MathJax_Vector-Bold')}
@font-face {font-family: MJXc-TeX-vec-Bx; src: local('MathJax_Vector'); font-weight: bold}
@font-face {font-family: MJXc-TeX-vec-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Bold.otf') format('opentype')}
</style></head>

  <body><div id="MathJax_Message" style="display: none;"></div>
    <!--- Header and nav template site-wide -->
<header>
    <nav class="group">
    <a href="https://ermongroup.github.io/cs228-notes/">Contents</a>
    <a href="http://cs228.stanford.edu/">Class</a>
    <a href="http://github.com/ermongroup/cs228-notes">GitHub</a>
    </nav>
</header>

    <article class="group">
      <h1>The variational auto-encoder</h1>
<p class="subtitle"></p>


<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    TeX: {
      Macros: {
        e: "\\epsilon",
        xti: "x^{(i)}",
        yti: "y^{(i)}",
        bfy: "{\\bf y}",
        bfx: "{\\bf x}",
        bfg: "{\\bf g}",
        bfbeta: "{\\bf \\beta}",
        tp: "\\tilde p",
        pt: "p_\\theta",
        E: "{\\mathbb{E}}",
        Ind: "{\\mathbb{I}}",
        KL: "{\\mathbb{KL}}",
        Re: "{\\mathbb{R}}",
        Dc: "{\\mathcal{D}}",
        Tc: "{\\mathcal{T}}",
        Xc: "{\\mathcal{X}}",
        note: ["\\textcolor{blue}{[NOTE: #1]}",1]
      }
    }
  });
</script>


<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot; /&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-1">\DeclareMathOperator{\diag}{diag}</script>

<p>In this chapter, we are going to use various ideas that we have learned in the class in order to present a very influential recent probabilistic model called the <em>variational autoencoder</em>.</p>

<p>Variational autoencoders (VAEs) are a deep learning technique for learning latent representations. They have also been used to <a href="https://arxiv.org/pdf/1502.04623.pdf">draw images</a>, achieve state-of-the-art results in <a href="https://arxiv.org/pdf/1602.05473.pdf">semi-supervised learning</a>, as well as <a href="https://arxiv.org/abs/1511.06349">interpolate between sentences</a>.</p>

<p>There are many online tutorials on VAEs. Our presentation will probably be a bit more technical than the average, since our goal will be to highlight connections to ideas seen in class, as well as to show how these ideas are useful in machine learning research.</p>

<h2 id="deep-generative-models">Deep generative models</h2>

<p>Consider a <a href="https://ermongroup.github.io/cs228-notes/representation/directed">directed</a> <a href="https://ermongroup.github.io/cs228-notes/learning/latent">latent-variable</a> model of the form</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-3" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4" class="mjx-mrow"><span id="MJXc-Node-5" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-6" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-7" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-8" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-9" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-10" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-11" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-12" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-13" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-14" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-15" class="mjx-texatom"><span id="MJXc-Node-16" class="mjx-mrow"><span id="MJXc-Node-17" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-18" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-19" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-20" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-21" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-22" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-23" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-2">p(x,z) = p(x|z)p(z)</script>

<p>with observed <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-24" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-25" class="mjx-mrow"><span id="MJXc-Node-26" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-27" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.256em; padding-bottom: 0.357em;">∈</span></span><span id="MJXc-Node-28" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-29" class="mjx-mrow"><span id="MJXc-Node-30" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.408em; padding-bottom: 0.306em; padding-right: 0.094em;">X</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">X</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3">x \in \mathcal{X}</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-31" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-32" class="mjx-mrow"><span id="MJXc-Node-33" class="mjx-texatom"><span id="MJXc-Node-34" class="mjx-mrow"><span id="MJXc-Node-35" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.408em; padding-bottom: 0.306em; padding-right: 0.094em;">X</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">X</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4">\mathcal{X}</script> can be continuous or discrete, and latent <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-36" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-37" class="mjx-mrow"><span id="MJXc-Node-38" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-39" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.256em; padding-bottom: 0.357em;">∈</span></span><span id="MJXc-Node-40" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-41" class="mjx-texatom"><span id="MJXc-Node-42" class="mjx-mrow"><span id="MJXc-Node-43" class="mjx-texatom"><span id="MJXc-Node-44" class="mjx-mrow"><span id="MJXc-Node-45" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.458em; padding-bottom: 0.306em;">R</span></span></span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-46" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></mrow><mi>k</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">z \in \Re^k</script>.</p>

<p><label for="faces" class="margin-toggle">⊕</label>
<input type="checkbox" id="faces" class="margin-toggle">
<span class="marginnote"><img class="fullwidth" src="./The variational auto-encoder_files/faces.png" alt="Variational autoencoder $$p(x|z)p(z)$$ applied to a face images (modeled by $$x$$). The learned latent space $$z$$ can be used to interpolate between facial expressions."><br>
    Variational autoencoder <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-47" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-48" class="mjx-mrow"><span id="MJXc-Node-49" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-50" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-51" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-52" class="mjx-texatom"><span id="MJXc-Node-53" class="mjx-mrow"><span id="MJXc-Node-54" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-55" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-56" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-57" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-58" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-59" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-60" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">p(x|z)p(z)</script> applied to a face images (modeled by <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-61" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-62" class="mjx-mrow"><span id="MJXc-Node-63" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">x</script>). The learned latent space <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-64" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-65" class="mjx-mrow"><span id="MJXc-Node-66" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">z</script> can be used to interpolate between facial expressions.
</span>
To make things concrete, you may think of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-67" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-68" class="mjx-mrow"><span id="MJXc-Node-69" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">x</script> as being an image (e.g. a human face), and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-70" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-71" class="mjx-mrow"><span id="MJXc-Node-72" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">z</script> as latent factors (not seen during training) that explain features of the face. For example, one coordinate of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-73" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-74" class="mjx-mrow"><span id="MJXc-Node-75" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">z</script> can encode whether the face is happy or sad, another one whether the face is male or female, etc.</p>

<p>We may also be interested in models with many layers, e.g. <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-76" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-77" class="mjx-mrow"><span id="MJXc-Node-78" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-79" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-80" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-81" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-82" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-83" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-84" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1</span></span></span></span><span id="MJXc-Node-85" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span><span id="MJXc-Node-86" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-87" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-88" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-89" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-90" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1</span></span></span></span><span id="MJXc-Node-91" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-92" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-93" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-94" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">2</span></span></span></span><span id="MJXc-Node-95" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span><span id="MJXc-Node-96" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-97" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-98" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-99" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-100" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">2</span></span></span></span><span id="MJXc-Node-101" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-102" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-103" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-104" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">3</span></span></span></span><span id="MJXc-Node-105" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span><span id="MJXc-Node-106" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.306em;">⋯</span></span><span id="MJXc-Node-107" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-108" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-109" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-110" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-111" class="mjx-texatom" style=""><span id="MJXc-Node-112" class="mjx-mrow"><span id="MJXc-Node-113" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">m</span></span><span id="MJXc-Node-114" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.306em; padding-bottom: 0.408em;">−</span></span><span id="MJXc-Node-115" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1</span></span></span></span></span></span><span id="MJXc-Node-116" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-117" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-118" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-119" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">m</span></span></span></span><span id="MJXc-Node-120" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span><span id="MJXc-Node-121" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-122" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-123" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-124" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-125" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">m</span></span></span></span><span id="MJXc-Node-126" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>∣</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mn>2</mn></msub><mo>∣</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>⋯</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>z</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>m</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">p(x \mid z_1)p(z_1 \mid z_2)p(z_2 \mid z_3)\cdots p(z_{m-1}\mid z_m)p(z_m)</script>. These are often called <em>deep generative models</em> and can learn hierarchies of latent representations.
In this chapter, we will assume for simplicity that there is only one latent layer.</p>

<h3 id="learning-deep-generative-models">Learning deep generative models</h3>

<p>Suppose now that we are given a dataset <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-127" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-128" class="mjx-mrow"><span id="MJXc-Node-129" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.256em;">D</span></span><span id="MJXc-Node-130" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.104em; padding-bottom: 0.306em;">=</span></span><span id="MJXc-Node-131" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">{</span></span><span id="MJXc-Node-132" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-133" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-134" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1</span></span></span></span><span id="MJXc-Node-135" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-136" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-137" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-138" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">2</span></span></span></span><span id="MJXc-Node-139" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-140" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.357em;">…</span></span><span id="MJXc-Node-141" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-142" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-143" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-144" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">n</span></span></span></span><span id="MJXc-Node-145" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">}</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><msup><mi>x</mi><mn>1</mn></msup><mo>,</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><mo>…</mo><mo>,</mo><msup><mi>x</mi><mi>n</mi></msup><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-13">D = \{x^1, x^2, \dotsc, x^n\}</script>. We are interested in the following <a href="https://ermongroup.github.io/cs228-notes/inference/variational/">inference</a> and <a href="https://ermongroup.github.io/cs228-notes/learning/directed/">learning</a> tasks:</p>

<ul>
  <li>Learning the parameters <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-146" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-147" class="mjx-mrow"><span id="MJXc-Node-148" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">\theta</script> of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-149" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-150" class="mjx-mrow"><span id="MJXc-Node-151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">p</script>.</li>
  <li>Approximate posterior inference over <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-152" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-153" class="mjx-mrow"><span id="MJXc-Node-154" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">z</script>: given an image <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-155" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-156" class="mjx-mrow"><span id="MJXc-Node-157" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">x</script>, what are its latent factors?</li>
  <li>Approximate marginal inference over <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-158" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-159" class="mjx-mrow"><span id="MJXc-Node-160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">x</script>: given an image <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-161" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-162" class="mjx-mrow"><span id="MJXc-Node-163" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">x</script> with missing parts, how do we fill-in these parts?</li>
</ul>

<p>We are also going to make the following additional assumptions:</p>

<ul>
  <li><em>Intractability</em>: computing the posterior probability <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-164" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-165" class="mjx-mrow"><span id="MJXc-Node-166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-167" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-168" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-169" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-170" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-171" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">p(z\mid x)</script> is intractable.</li>
  <li><em>Big data</em>: the dataset <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-172" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-173" class="mjx-mrow"><span id="MJXc-Node-174" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.256em;">D</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">D</script> is too large to fit in memory; we can only work with small, subsampled batches of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-175" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-176" class="mjx-mrow"><span id="MJXc-Node-177" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.256em;">D</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">D</script>.</li>
</ul>

<p>Many interesting models fall in this class; the variational auto-encoder will be one such model.</p>

<h2 id="trying-out-the-standard-approaches">Trying out the standard approaches</h2>

<p>We have learned several techniques in the class that could be used to solve our three tasks. Let’s try them out.</p>

<p>The <a href="https://ermongroup.github.io/cs228-notes/learning/latent/">EM algorithm</a> can be used to learn latent-variable models. Recall, however, that performing the E step requires computing the approximate posterior <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-178" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-179" class="mjx-mrow"><span id="MJXc-Node-180" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-181" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-182" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-183" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-184" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-185" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">p(z\mid x)</script>, which we have assumed to be intractable. In the M step, we learn the <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-186" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-187" class="mjx-mrow"><span id="MJXc-Node-188" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">\theta</script> by looking at the entire dataset<label for="note-onlineEM" class="margin-toggle sidenote-number"></label><input type="checkbox" id="note-onlineEM" class="margin-toggle"><span class="sidenote">Note, however, that there exists a generalization called online EM, which performs the M-step over mini-batches.</span>, which is going to be too large to hold in memory.</p>

<p>To perform approximate inference, we may use <a href="https://ermongroup.github.io/cs228-notes/inference/variational/">mean field</a>. Recall, however, that one step of mean field requires us to compute an expectation whose time complexity scales exponentially with the size of the Markov blanket of the target variable.</p>

<p>What is the size of the <a href="https://ermongroup.github.io/cs228-notes/representation/undirected/">Markov blanket</a> for <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-189" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-190" class="mjx-mrow"><span id="MJXc-Node-191" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">z</script>? If we assume that at least one component of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-192" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-193" class="mjx-mrow"><span id="MJXc-Node-194" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">x</script> depends on each component of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-195" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-196" class="mjx-mrow"><span id="MJXc-Node-197" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">z</script>, then this introduces a <a href="https://ermongroup.github.io/cs228-notes/representation/directed/">V-structure</a> into the graph of our model (the <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-198" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-199" class="mjx-mrow"><span id="MJXc-Node-200" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">x</script>, which are observed, are <a href="https://ermongroup.github.io/cs228-notes/representation/directed/">explaining away</a> the differences among the <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-201" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-202" class="mjx-mrow"><span id="MJXc-Node-203" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">z</script>). Thus, we know that all the <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-204" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-205" class="mjx-mrow"><span id="MJXc-Node-206" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">z</script> variables will depend on each other and the Markov blanket of some <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-207" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-208" class="mjx-mrow"><span id="MJXc-Node-209" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-210" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-211" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">z_i</script> will contain all the other <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-212" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-213" class="mjx-mrow"><span id="MJXc-Node-214" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">z</script>-variables. This will make mean-field intractable<label for="note-meanfield" class="margin-toggle sidenote-number"></label><input type="checkbox" id="note-meanfield" class="margin-toggle"><span class="sidenote">The authors refer to this when they say “the required integrals for any reasonable mean-field VB algorithm are also intractable.” They also discuss the limitations of EM and sampling methods in the introduction and the methods section.</span>. An equivalent (and simpler) explanation is that <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-215" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-216" class="mjx-mrow"><span id="MJXc-Node-217" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">p</script> will contain a factor <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-218" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-219" class="mjx-mrow"><span id="MJXc-Node-220" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-221" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-222" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-223" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-224" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">i</span></span></span></span><span id="MJXc-Node-225" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-226" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-227" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-228" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1</span></span></span></span><span id="MJXc-Node-229" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-230" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.357em;">…</span></span><span id="MJXc-Node-231" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-232" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-233" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-234" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">k</span></span></span></span><span id="MJXc-Node-235" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-34">p(x_i \mid z_1, \dotsc, z_k)</script>, in which all the <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-236" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-237" class="mjx-mrow"><span id="MJXc-Node-238" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">z</script> variables are tied.</p>

<p>Another approach would be to use <a href="https://ermongroup.github.io/cs228-notes/inference/sampling/">sampling-based methods</a>. In their seminal 2013 <a href="https://arxiv.org/abs/1312.6114">paper</a> first describing the variational autoencoder, Kingma and Welling compare the VAE against these kinds of algorithms, but they find that these sampling-based methods don’t scale well to large datasets. In addition, techniques such as <a href="https://ermongroup.github.io/cs228-notes/inference/sampling/">Metropolis-Hastings</a> require a hand-crafted proposal distribution, which might be difficult to choose.</p>

<h2 id="auto-encoding-variational-bayes">Auto-encoding variational Bayes</h2>

<p>We are now going to learn about Auto-encoding variational Bayes (AEVB), an algorithm that can efficiently solve our three inference and learning tasks; the variational auto-encoder will be one instantiation of this algorithm.</p>

<p>AEVB is based on ideas from <a href="https://ermongroup.github.io/cs228-notes/inference/variational/">variational inference</a>. Recall that in variational inference, we are interested in maximizing the <a href="https://ermongroup.github.io/cs228-notes/inference/variational/#the-variational-lower-bound">evidence lower bound</a> (ELBO)</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-239" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-240" class="mjx-mrow"><span id="MJXc-Node-241" class="mjx-texatom"><span id="MJXc-Node-242" class="mjx-mrow"><span id="MJXc-Node-243" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">L</span></span></span></span><span id="MJXc-Node-244" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-245" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-246" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-247" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-248" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-249" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-250" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-251" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-252" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-253" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-254" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-255" class="mjx-texatom"><span id="MJXc-Node-256" class="mjx-mrow"><span id="MJXc-Node-257" class="mjx-texatom"><span id="MJXc-Node-258" class="mjx-mrow"><span id="MJXc-Node-259" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-260" class="mjx-texatom" style=""><span id="MJXc-Node-261" class="mjx-mrow"><span id="MJXc-Node-262" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-263" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 80.2%; vertical-align: -0.278em; padding-right: 0.062em;"><span id="MJXc-Node-264" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-265" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-266" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-267" class="mjx-texatom"><span id="MJXc-Node-268" class="mjx-mrow"><span id="MJXc-Node-269" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-270" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-271" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-272" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-273" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">[</span></span><span id="MJXc-Node-274" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-275" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-276" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-277" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-278" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-279" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-280" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-281" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-282" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-283" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-284" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">−</span></span><span id="MJXc-Node-285" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-286" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-287" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-288" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-289" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-290" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-291" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-292" class="mjx-texatom"><span id="MJXc-Node-293" class="mjx-mrow"><span id="MJXc-Node-294" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-295" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-296" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-297" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mi>θ</mi></msub><mo>,</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-36">\mathcal{L}(p_\theta,q_\phi) = \E_{q_\phi(z|x)} \left[ \log p_\theta(x,z) - \log q_\phi(z|x) \right]</script>

<p>over the space of all <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-298" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-299" class="mjx-mrow"><span id="MJXc-Node-300" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-301" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-302" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>ϕ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">q_\phi</script>. The ELBO satisfies the equation</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-303" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-304" class="mjx-mrow"><span id="MJXc-Node-305" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-306" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-307" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-308" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-309" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-310" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-311" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-312" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-313" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-314" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.429em; padding-bottom: 0.287em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-315" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.429em; padding-bottom: 0.287em;">L</span></span><span id="MJXc-Node-316" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-317" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-319" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-320" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-321" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-322" class="mjx-texatom"><span id="MJXc-Node-323" class="mjx-mrow"><span id="MJXc-Node-324" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-325" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-326" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-327" class="mjx-texatom"><span id="MJXc-Node-328" class="mjx-mrow"><span id="MJXc-Node-329" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-330" class="mjx-texatom"><span id="MJXc-Node-331" class="mjx-mrow"><span id="MJXc-Node-332" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-333" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-334" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-335" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-336" class="mjx-texatom"><span id="MJXc-Node-337" class="mjx-mrow"><span id="MJXc-Node-338" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-339" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-340" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-341" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-342" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">+</span></span><span id="MJXc-Node-343" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-344" class="mjx-mrow"><span id="MJXc-Node-345" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">L</span></span></span></span><span id="MJXc-Node-346" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-347" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-348" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-349" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-350" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-351" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-352" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-353" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-354" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-355" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.358em;">.</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>K</mi><mi>L</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mi>θ</mi></msub><mo>,</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">)</mo><mo>.</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-38">\log p_\theta(x) = KL(q_\phi(z|x) || p(z|x)) + \mathcal{L}(p_\theta,q_\phi).</script>

<p>Since <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-356" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-357" class="mjx-mrow"><span id="MJXc-Node-358" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">x</script> is fixed, we can define <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-359" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-360" class="mjx-mrow"><span id="MJXc-Node-361" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-362" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-364" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-365" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-366" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">q(z\mid x)</script> to be conditioned on <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-367" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-368" class="mjx-mrow"><span id="MJXc-Node-369" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">x</script>. This means that we are effectively choosing a different <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-370" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-371" class="mjx-mrow"><span id="MJXc-Node-372" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-373" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-375" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">q(z)</script> for every <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-376" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-377" class="mjx-mrow"><span id="MJXc-Node-378" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">x</script>, which will produce a better posterior approximation than always choosing the same <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-379" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-380" class="mjx-mrow"><span id="MJXc-Node-381" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-382" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-383" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-384" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">q(z)</script>.</p>

<p>How exactly do we optimize over <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-385" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-386" class="mjx-mrow"><span id="MJXc-Node-387" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-388" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-389" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-390" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-391" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-392" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">q(z\mid x)</script>? We may use <a href="https://ermongroup.github.io/cs228-notes/inference/variational/">mean field</a>, but this turns out to be insufficiently accurate for our purposes. The assumption that <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-393" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-394" class="mjx-mrow"><span id="MJXc-Node-395" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">q</script> is fully factored is too strong, and the coordinate descent optimization algorithm is too simplistic.</p>

<h3 id="black-box-variational-inference">Black-box variational inference</h3>

<p>The first important idea used in the AEVB algorithm is a general purpose approach for optimizing <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-396" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-397" class="mjx-mrow"><span id="MJXc-Node-398" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">q</script> that works for large classes of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-399" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-400" class="mjx-mrow"><span id="MJXc-Node-401" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">q</script> (that are more complex than in mean field). We later combine this algorithm with specific choices of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-49-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-402" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-403" class="mjx-mrow"><span id="MJXc-Node-404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">q</script>.</p>

<p>This approach – called <em>black-box variational inference</em><label for="note-blackbox" class="margin-toggle sidenote-number"></label><input type="checkbox" id="note-blackbox" class="margin-toggle"><span class="sidenote">The term <em>black-box variational inference</em> was first coined by <a href="http://www.cs.columbia.edu/~blei/papers/RanganathGerrishBlei2014.pdf">Ranganath et al.</a>, with the ideas being inspired by earlier work, such as the Wake-Sleep algorithm.</span> – consists of maximizing the ELBO using <a href="https://ermongroup.github.io/cs228-notes/learning/undirected/">gradient descent</a> over <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-405" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-406" class="mjx-mrow"><span id="MJXc-Node-407" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">\phi</script> (instead of e.g., using a coordinate descent algorithm like mean field). Hence, it only assumes that <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-51-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-408" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-409" class="mjx-mrow"><span id="MJXc-Node-410" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-411" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-412" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>ϕ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-51">q_\phi</script> is differentiable in its parameters <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-413" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-414" class="mjx-mrow"><span id="MJXc-Node-415" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">\phi</script>.</p>

<p>Furthermore, instead of only doing inference, we will simultaneously perform learning via gradient descent on both <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-416" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-417" class="mjx-mrow"><span id="MJXc-Node-418" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">\phi</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-419" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-420" class="mjx-mrow"><span id="MJXc-Node-421" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">\theta</script> (jointly). Optimization over <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-422" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-423" class="mjx-mrow"><span id="MJXc-Node-424" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">\phi</script> will keep ELBO tight around <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-425" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-426" class="mjx-mrow"><span id="MJXc-Node-427" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.408em; padding-bottom: 0.56em;">log</span></span><span id="MJXc-Node-428" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-429" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-430" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-431" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-432" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">\log p(x)</script>; optimization over <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-433" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-434" class="mjx-mrow"><span id="MJXc-Node-435" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">\theta</script> will keep pushing the lower bound (and hence <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-436" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-437" class="mjx-mrow"><span id="MJXc-Node-438" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.408em; padding-bottom: 0.56em;">log</span></span><span id="MJXc-Node-439" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-440" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-441" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-443" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-58">\log p(x)</script>) up. This is somewhat similar to how the <a href="https://ermongroup.github.io/cs228-notes/learning/latent/">EM algorithm</a> optimizes a lower bound on the marginal likelihood.</p>

<h3 id="the-score-function-gradient-estimator">The score function gradient estimator</h3>

<p>To perform black-box variational inference, we need to compute the gradient</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-444" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-445" class="mjx-mrow"><span id="MJXc-Node-446" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-447" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-448" class="mjx-texatom" style=""><span id="MJXc-Node-449" class="mjx-mrow"><span id="MJXc-Node-450" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span><span id="MJXc-Node-451" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-452" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span></span></span><span id="MJXc-Node-453" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-454" class="mjx-texatom"><span id="MJXc-Node-455" class="mjx-mrow"><span id="MJXc-Node-456" class="mjx-texatom"><span id="MJXc-Node-457" class="mjx-mrow"><span id="MJXc-Node-458" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-459" class="mjx-texatom" style=""><span id="MJXc-Node-460" class="mjx-mrow"><span id="MJXc-Node-461" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-462" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 80.2%; vertical-align: -0.278em; padding-right: 0.062em;"><span id="MJXc-Node-463" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-464" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-465" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-466" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-467" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-468" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">[</span></span><span id="MJXc-Node-469" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-470" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-471" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-472" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-473" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-474" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-475" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-476" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-477" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-478" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-479" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">−</span></span><span id="MJXc-Node-480" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-481" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-482" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-483" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-484" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-485" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-486" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-487" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-488" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi><mo>,</mo><mi>ϕ</mi></mrow></msub><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-59">\nabla_{\theta, \phi} \E_{q_\phi(z)} \left[ \log p_\theta(x,z) - \log q_\phi(z) \right]</script>

<p>Taking the expectation with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-489" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-490" class="mjx-mrow"><span id="MJXc-Node-491" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">q</script> in closed form will often not be possible. Instead, we may take <a href="https://ermongroup.github.io/cs228-notes/inference/sampling/">Monte Carlo</a> estimates of the gradient by sampling from <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-61-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-492" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-493" class="mjx-mrow"><span id="MJXc-Node-494" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">q</script>. This is easy to do for the gradient of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-62-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-495" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-496" class="mjx-mrow"><span id="MJXc-Node-497" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">p</script>: we may swap the gradient and the expectation and estimate the following expression via Monte Carlo</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-63-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-498" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-499" class="mjx-mrow"><span id="MJXc-Node-500" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-501" class="mjx-texatom"><span id="MJXc-Node-502" class="mjx-mrow"><span id="MJXc-Node-503" class="mjx-texatom"><span id="MJXc-Node-504" class="mjx-mrow"><span id="MJXc-Node-505" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-506" class="mjx-texatom" style=""><span id="MJXc-Node-507" class="mjx-mrow"><span id="MJXc-Node-508" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 80.2%; vertical-align: -0.278em; padding-right: 0.062em;"><span id="MJXc-Node-510" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-511" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-512" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-513" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-514" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-515" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">[</span></span><span id="MJXc-Node-516" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-517" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-518" class="mjx-texatom" style=""><span id="MJXc-Node-519" class="mjx-mrow"><span id="MJXc-Node-520" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span></span></span><span id="MJXc-Node-521" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-522" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-523" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-524" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-525" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-526" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-527" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-528" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-529" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-530" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-531" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-63">\E_{q_\phi(z)} \left[ \nabla_{\theta} \log p_\theta(x,z) \right]</script>

<p>However, taking the gradient with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-64-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-532" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-533" class="mjx-mrow"><span id="MJXc-Node-534" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-64">q</script> is more difficult. Notice that we cannot swap the gradient and the expectation, since the expectation is being taken with respect to the distribution that we are trying to differentiate!</p>

<p>One way to estimate this gradient is via the so-called score function estimator:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-65-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-535" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-536" class="mjx-mrow"><span id="MJXc-Node-537" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-538" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-539" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-540" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-541" class="mjx-texatom"><span id="MJXc-Node-542" class="mjx-mrow"><span id="MJXc-Node-543" class="mjx-texatom"><span id="MJXc-Node-544" class="mjx-mrow"><span id="MJXc-Node-545" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-546" class="mjx-texatom" style=""><span id="MJXc-Node-547" class="mjx-mrow"><span id="MJXc-Node-548" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 80.2%; vertical-align: -0.278em; padding-right: 0.062em;"><span id="MJXc-Node-550" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-551" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-552" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-553" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-554" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-555" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">[</span></span><span id="MJXc-Node-556" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-557" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-558" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-559" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-560" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-561" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-562" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-563" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-564" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-565" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-566" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">−</span></span><span id="MJXc-Node-567" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-568" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-569" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-570" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-571" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-572" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-573" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-574" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-575" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">]</span></span></span><span id="MJXc-Node-576" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-577" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-578" class="mjx-texatom"><span id="MJXc-Node-579" class="mjx-mrow"><span id="MJXc-Node-580" class="mjx-texatom"><span id="MJXc-Node-581" class="mjx-mrow"><span id="MJXc-Node-582" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-583" class="mjx-texatom" style=""><span id="MJXc-Node-584" class="mjx-mrow"><span id="MJXc-Node-585" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-586" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 80.2%; vertical-align: -0.278em; padding-right: 0.062em;"><span id="MJXc-Node-587" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-588" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-589" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-590" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-591" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-592" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">[</span></span><span id="MJXc-Node-593" class="mjx-mrow"><span id="MJXc-Node-594" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">(</span></span><span id="MJXc-Node-595" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-596" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-597" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-598" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-599" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-600" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-601" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-602" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-603" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-604" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-605" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">−</span></span><span id="MJXc-Node-606" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-607" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-608" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-609" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-610" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-611" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-612" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-613" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-614" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">)</span></span></span><span id="MJXc-Node-615" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-616" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-617" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-618" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-619" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-620" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-621" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-622" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-623" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-624" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-625" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-626" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>ϕ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>]</mo></mrow><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><mrow><mo>(</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>)</mo></mrow><msub><mi mathvariant="normal">∇</mi><mi>ϕ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-65">\nabla_\phi \E_{q_\phi(z)} \left[ \log p_\theta(x,z) - \log q_\phi(z) \right] = \E_{q_\phi(z)} \left[ \left(\log p_\theta(x,z) - \log q_\phi(z) \right) \nabla_\phi \log q_\phi(z) \right]</script>

<p>This follows from some basic algebra and calculus and takes about half a page to derive. We leave it as an exercise to the reader, but for those interested, the full derivation may be found in Appendix B of this <a href="https://www.cs.toronto.edu/~amnih/papers/nvil.pdf">paper</a>.</p>

<p>The above identity places the gradient inside the expectation, which we may now evaluate using Monte Carlo. We refer to this as the <em>score function</em> estimator of the gradient.</p>

<p>Unfortunately, the score function estimator has an important shortcoming: it has a high variance. What does this mean? Suppose you are using Monte Carlo to estimate some quantity with expected value equal to 1. If your samples are <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-66-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0.9&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1.1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0.96&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1.05&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-627" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-628" class="mjx-mrow"><span id="MJXc-Node-629" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">0.9</span></span><span id="MJXc-Node-630" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-631" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1.1</span></span><span id="MJXc-Node-632" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-633" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">0.96</span></span><span id="MJXc-Node-634" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-635" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1.05</span></span><span id="MJXc-Node-636" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-637" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.357em;">…</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.9</mn><mo>,</mo><mn>1.1</mn><mo>,</mo><mn>0.96</mn><mo>,</mo><mn>1.05</mn><mo>,</mo><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">0.9, 1.1, 0.96, 1.05, \dotsc</script> and are close to 1, then after a few samples, you will get a good estimate of the true expectation. If on the other hand you sample zero 99 times out of 100, and you sample 100 once, the expectation is still correct, but you will have to take a very large number of samples to figure out that the true expectation is actually one. We refer to the latter case as being high variance.</p>

<p>This is the kind of problem we often run into with the score function estimator. In fact, its variance is so high, that we cannot use it to learn many models.</p>

<p>The key contribution of the VAE paper is to propose an alternative estimator that is much better behaved. This is done in two steps: we first reformulate the ELBO so that parts of it can be computed in closed form (without Monte Carlo), and then we use an alternative gradient estimator, based on the so-called reparametrization trick.</p>

<h3 id="the-sgvb-estimator">The SGVB estimator</h3>

<p>The reformulation of the ELBO is as follows:</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-67-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-638" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-639" class="mjx-mrow"><span id="MJXc-Node-640" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-641" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-642" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-643" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-644" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-645" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-646" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.358em; padding-bottom: 0.5em;">≥</span></span><span id="MJXc-Node-647" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-648" class="mjx-texatom"><span id="MJXc-Node-649" class="mjx-mrow"><span id="MJXc-Node-650" class="mjx-texatom"><span id="MJXc-Node-651" class="mjx-mrow"><span id="MJXc-Node-652" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-653" class="mjx-texatom" style=""><span id="MJXc-Node-654" class="mjx-mrow"><span id="MJXc-Node-655" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-656" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 80.2%; vertical-align: -0.278em; padding-right: 0.062em;"><span id="MJXc-Node-657" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-658" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-659" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-660" class="mjx-texatom"><span id="MJXc-Node-661" class="mjx-mrow"><span id="MJXc-Node-662" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-663" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-664" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-665" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-666" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">[</span></span><span id="MJXc-Node-667" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">log</span></span><span id="MJXc-Node-668" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-669" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-670" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-671" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.287em;">θ</span></span></span></span><span id="MJXc-Node-672" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-673" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-674" class="mjx-texatom"><span id="MJXc-Node-675" class="mjx-mrow"><span id="MJXc-Node-676" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-677" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-678" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-679" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">]</span></span></span><span id="MJXc-Node-680" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">−</span></span><span id="MJXc-Node-681" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.429em; padding-bottom: 0.287em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-682" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.429em; padding-bottom: 0.287em;">L</span></span><span id="MJXc-Node-683" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-684" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-685" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-686" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-687" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-688" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-689" class="mjx-texatom"><span id="MJXc-Node-690" class="mjx-mrow"><span id="MJXc-Node-691" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-692" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-693" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-694" class="mjx-texatom"><span id="MJXc-Node-695" class="mjx-mrow"><span id="MJXc-Node-696" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-697" class="mjx-texatom"><span id="MJXc-Node-698" class="mjx-mrow"><span id="MJXc-Node-699" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">|</span></span></span></span><span id="MJXc-Node-700" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-701" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-702" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-703" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-704" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≥</mo><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo><mo>]</mo></mrow><mo>−</mo><mi>K</mi><mi>L</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-67">\log p(x) \geq \E_{q_\phi(z|x)} \left[ \log p_\theta(x|z) \right] - KL(q_\phi(z|x) || p(z))</script>

<p>It is straightforward to verify that this is the same as ELBO using some algebra.</p>

<p>This reparametrization has a very interesting interpretation. First, think of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-68-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-705" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-706" class="mjx-mrow"><span id="MJXc-Node-707" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">x</script> as an observed data point. The right-hand side consists of two terms; both involve taking a sample <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-69-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-708" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-709" class="mjx-mrow"><span id="MJXc-Node-710" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-711" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.104em; padding-bottom: 0.306em;">∼</span></span><span id="MJXc-Node-712" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-713" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-714" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-715" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-716" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-717" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∼</mo><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">z \sim q(z\mid x)</script>, which we can interpret as a code describing <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-70-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-718" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-719" class="mjx-mrow"><span id="MJXc-Node-720" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">x</script>. We are also going to call <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-71-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-721" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-722" class="mjx-mrow"><span id="MJXc-Node-723" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">q</script> the <em>encoder</em>.</p>

<p>The first term <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-72-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-724" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-725" class="mjx-mrow"><span id="MJXc-Node-726" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.408em; padding-bottom: 0.56em;">log</span></span><span id="MJXc-Node-727" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-728" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-729" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-730" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-731" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-732" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-733" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">\log p(x\mid z)</script> is the log-likelihood of the observed <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-73-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-734" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-735" class="mjx-mrow"><span id="MJXc-Node-736" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">x</script> given the code <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-74-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-737" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-738" class="mjx-mrow"><span id="MJXc-Node-739" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-74">z</script> that we have sampled. This term is maximized when <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-75-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-740" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-741" class="mjx-mrow"><span id="MJXc-Node-742" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-743" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-744" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-745" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-746" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-747" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-75">p(x\mid z)</script> assigns high probability to the original <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-76-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-748" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-749" class="mjx-mrow"><span id="MJXc-Node-750" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">x</script>. It is trying to reconstruct <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-77-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-751" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-752" class="mjx-mrow"><span id="MJXc-Node-753" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">x</script> given the code <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-78-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-754" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-755" class="mjx-mrow"><span id="MJXc-Node-756" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">z</script>; for that reason we call <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-79-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-757" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-758" class="mjx-mrow"><span id="MJXc-Node-759" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-760" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-761" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-762" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-763" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-764" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">p(x\mid z)</script> the <em>decoder</em> network and the term is called the <em>reconstruction error</em>.</p>

<p>The second term is the divergence between <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-80-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-765" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-766" class="mjx-mrow"><span id="MJXc-Node-767" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-768" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-769" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-770" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-771" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-772" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-80">q(z\mid x)</script> and the prior <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-81-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-773" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-774" class="mjx-mrow"><span id="MJXc-Node-775" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-776" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-777" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-778" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-81">p(z)</script>, which we will fix to be a unit Normal. It encourages the codes <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-82-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-779" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-780" class="mjx-mrow"><span id="MJXc-Node-781" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">z</script> to look Gaussian. We call it the <em>regularization</em> term. It prevents <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-83-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-782" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-783" class="mjx-mrow"><span id="MJXc-Node-784" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-785" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-786" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-787" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-788" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-789" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">q(z\mid x)</script> from simply encoding an identity mapping, and instead forces it to learn some more interesting representation (e.g. facial features in our first example).</p>

<p>Thus, our optimization objective is trying to fit a <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-84-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-790" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-791" class="mjx-mrow"><span id="MJXc-Node-792" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-793" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-794" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-795" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-796" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-797" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-84">q(z\mid x)</script> that will map <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-85-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-798" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-799" class="mjx-mrow"><span id="MJXc-Node-800" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">x</script> into a useful latent space <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-86-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-801" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-802" class="mjx-mrow"><span id="MJXc-Node-803" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">z</script> from which we are able to reconstruct <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-87-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-804" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-805" class="mjx-mrow"><span id="MJXc-Node-806" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">x</script> via <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-88-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-807" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-808" class="mjx-mrow"><span id="MJXc-Node-809" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-810" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-811" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-812" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-813" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-814" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-88">p(x\mid z)</script>. This type of objective is reminiscent of <em>auto-encoder</em> neural networks<label for="note-autoencoder" class="margin-toggle sidenote-number"></label><input type="checkbox" id="note-autoencoder" class="margin-toggle"><span class="sidenote">An auto-encoder is a pair of neural networks <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-89-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-815" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-816" class="mjx-mrow"><span id="MJXc-Node-817" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-818" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-819" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.003em;">g</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo>,</mo><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">f, g</script> that are composed as <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-90-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x00AF;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-820" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-821" class="mjx-mrow"><span id="MJXc-Node-822" class="mjx-texatom"><span id="MJXc-Node-823" class="mjx-mrow"><span id="MJXc-Node-824" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.096em; padding-bottom: 0.06em; padding-left: 0.064em;"><span id="MJXc-Node-826" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.287em;">¯</span></span></span><span class="mjx-op"><span id="MJXc-Node-825" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span></span></span></span></span></span><span id="MJXc-Node-827" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-828" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-829" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-830" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-831" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-832" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-833" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-834" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">¯</mo></mover></mrow><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-90">\bar x=f(g(x))</script>. They are trained to minimize the reconstruction error <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-91-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x00AF;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-835" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-836" class="mjx-mrow"><span id="MJXc-Node-837" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">∥</span></span><span id="MJXc-Node-838" class="mjx-texatom"><span id="MJXc-Node-839" class="mjx-mrow"><span id="MJXc-Node-840" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.096em; padding-bottom: 0.06em; padding-left: 0.064em;"><span id="MJXc-Node-842" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.287em;">¯</span></span></span><span class="mjx-op"><span id="MJXc-Node-841" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span></span></span></span></span></span><span id="MJXc-Node-843" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">−</span></span><span id="MJXc-Node-844" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-845" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">∥</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">¯</mo></mover></mrow><mo>−</mo><mi>x</mi><mo fence="false" stretchy="false">‖</mo></math></span></span><script type="math/tex" id="MathJax-Element-91">\|\bar x - x\|</script>. In practice, <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-92-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-846" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-847" class="mjx-mrow"><span id="MJXc-Node-848" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-849" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-850" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-851" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-92">g(x)</script> learns to embed <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-93-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-852" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-853" class="mjx-mrow"><span id="MJXc-Node-854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">x</script> in a latent space that often has an intuitive interpretation.</span>. This is where the AEVB algorithm takes its name.</p>

<h3 id="the-reparametrization-trick">The reparametrization trick</h3>

<p>As we have seen earlier, optimizing our objective requires a good estimate of the gradient.
The main technical contribution of the VAE paper is a low-variance gradient estimator based on the <em>reparametrization trick</em>.</p>

<p>Under certain mild conditions, we may express the distribution <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-94-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-855" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-856" class="mjx-mrow"><span id="MJXc-Node-857" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-858" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-859" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span id="MJXc-Node-860" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-861" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-862" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-863" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-864" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-94">q_\phi(z\mid x)</script> as the following two-step generative process.</p>

<ul>
  <li>First, we sample a noise variable <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-95-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-865" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-866" class="mjx-mrow"><span id="MJXc-Node-867" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">ϵ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϵ</mi></math></span></span><script type="math/tex" id="MathJax-Element-95">\epsilon</script> from a simple distribution <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-96-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-868" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-869" class="mjx-mrow"><span id="MJXc-Node-870" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-871" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-872" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">ϵ</span></span><span id="MJXc-Node-873" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>ϵ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">p(\epsilon)</script> like the standard Normal <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-97-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-874" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-875" class="mjx-mrow"><span id="MJXc-Node-876" class="mjx-texatom"><span id="MJXc-Node-877" class="mjx-mrow"><span id="MJXc-Node-878" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.509em; padding-bottom: 0.357em; padding-right: 0.159em;">N</span></span></span></span><span id="MJXc-Node-879" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-880" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">0</span></span><span id="MJXc-Node-881" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-882" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1</span></span><span id="MJXc-Node-883" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-97">\mathcal{N}(0,1)</script></li>
</ul>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-98-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-884" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-885" class="mjx-mrow"><span id="MJXc-Node-886" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-887" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">∼</span></span><span id="MJXc-Node-888" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-889" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-890" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-891" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>ϵ</mi><mo>∼</mo><mi>p</mi><mo stretchy="false">(</mo><mi>ϵ</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-98">\epsilon \sim p(\epsilon)</script>

<ul>
  <li>Then, we apply a deterministic transformation <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-99-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-892" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-893" class="mjx-mrow"><span id="MJXc-Node-894" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-895" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-896" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span id="MJXc-Node-897" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-898" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">ϵ</span></span><span id="MJXc-Node-899" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-900" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-901" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>ϵ</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">g_\phi(\epsilon, x)</script> that maps the random noise into a more complex distribution.</li>
</ul>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-100-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-902" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-903" class="mjx-mrow"><span id="MJXc-Node-904" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-905" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-906" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-907" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-908" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-909" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-910" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-911" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-912" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-913" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><msub><mi>g</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>ϵ</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-100">z = g_\phi(\epsilon, x)</script>

<p>For many interesting classes of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-101-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-914" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-915" class="mjx-mrow"><span id="MJXc-Node-916" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-917" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-918" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>ϕ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-101">q_\phi</script>, it is possible to choose a <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-102-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-919" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-920" class="mjx-mrow"><span id="MJXc-Node-921" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-922" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-923" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span id="MJXc-Node-924" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-925" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">ϵ</span></span><span id="MJXc-Node-926" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-927" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-928" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>ϵ</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-102">g_\phi(\epsilon, x)</script>, such that <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-103-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-929" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-930" class="mjx-mrow"><span id="MJXc-Node-931" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-932" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.104em; padding-bottom: 0.306em;">=</span></span><span id="MJXc-Node-933" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-934" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-935" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span id="MJXc-Node-936" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-937" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">ϵ</span></span><span id="MJXc-Node-938" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-939" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-940" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>=</mo><msub><mi>g</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>ϵ</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-103">z = g_\phi(\epsilon, x)</script> will be distributed according to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-104-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-941" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-942" class="mjx-mrow"><span id="MJXc-Node-943" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-944" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-945" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em;">ϕ</span></span></span></span><span id="MJXc-Node-946" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-947" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-948" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-949" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-950" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-104">q_\phi(z\mid x)</script>.</p>

<p>Gaussian variables provide the simplest example of the reparametrization trick. Instead of writing <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-105-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-951" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-952" class="mjx-mrow"><span id="MJXc-Node-953" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-954" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.104em; padding-bottom: 0.306em;">∼</span></span><span id="MJXc-Node-955" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-956" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-957" class="mjx-texatom" style=""><span id="MJXc-Node-958" class="mjx-mrow"><span id="MJXc-Node-959" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.509em;">μ</span></span><span id="MJXc-Node-960" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-961" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.001em;">σ</span></span></span></span></span></span><span id="MJXc-Node-962" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-963" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-964" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span><span id="MJXc-Node-965" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.104em; padding-bottom: 0.306em;">=</span></span><span id="MJXc-Node-966" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-967" class="mjx-mrow"><span id="MJXc-Node-968" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.509em; padding-bottom: 0.357em; padding-right: 0.159em;">N</span></span></span></span><span id="MJXc-Node-969" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-970" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.509em;">μ</span></span><span id="MJXc-Node-971" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-972" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-973" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∼</mo><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi><mo>,</mo><mi>σ</mi></mrow></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-105">z \sim q_{\mu, \sigma}(z) = \mathcal{N}(\mu, \sigma)</script>, we may write</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-106-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-974" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-975" class="mjx-mrow"><span id="MJXc-Node-976" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-977" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-978" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-979" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-980" class="mjx-texatom" style=""><span id="MJXc-Node-981" class="mjx-mrow"><span id="MJXc-Node-982" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">μ</span></span><span id="MJXc-Node-983" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-984" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.001em;">σ</span></span></span></span></span></span><span id="MJXc-Node-985" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-986" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-987" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-988" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-989" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">μ</span></span><span id="MJXc-Node-990" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.287em; padding-bottom: 0.429em;">+</span></span><span id="MJXc-Node-991" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-992" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.287em;">⋅</span></span><span id="MJXc-Node-993" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-994" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi><mo>,</mo><mi>σ</mi></mrow></msub><mo stretchy="false">(</mo><mi>ϵ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>μ</mi><mo>+</mo><mi>ϵ</mi><mo>⋅</mo><mi>σ</mi><mo>,</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-106">z = g_{\mu, \sigma}(\epsilon) = \mu + \epsilon \cdot \sigma,</script>

<p>where <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-107-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-995" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-996" class="mjx-mrow"><span id="MJXc-Node-997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">ϵ</span></span><span id="MJXc-Node-998" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.104em; padding-bottom: 0.306em;">∼</span></span><span id="MJXc-Node-999" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-1000" class="mjx-mrow"><span id="MJXc-Node-1001" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.509em; padding-bottom: 0.357em; padding-right: 0.159em;">N</span></span></span></span><span id="MJXc-Node-1002" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1003" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">0</span></span><span id="MJXc-Node-1004" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-1005" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.357em; padding-bottom: 0.357em;">1</span></span><span id="MJXc-Node-1006" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϵ</mi><mo>∼</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-107">\epsilon \sim \mathcal{N}(0,1)</script>. It is easy to check that the two ways of expressing the random variable <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-108-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1007" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1008" class="mjx-mrow"><span id="MJXc-Node-1009" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">z</script> lead to the same distribution.</p>

<p>The biggest advantage of this approach is that we may now write the gradient of an expectation with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-109-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1010" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1011" class="mjx-mrow"><span id="MJXc-Node-1012" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-1013" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1014" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1015" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-109">q(z)</script> (for any <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-110-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1016" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1017" class="mjx-mrow"><span id="MJXc-Node-1018" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.458em; padding-right: 0.06em;">f</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-110">f</script>) as</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-111-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-1019" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1020" class="mjx-mrow"><span id="MJXc-Node-1021" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1022" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1023" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-1024" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1025" class="mjx-texatom"><span id="MJXc-Node-1026" class="mjx-mrow"><span id="MJXc-Node-1027" class="mjx-texatom"><span id="MJXc-Node-1028" class="mjx-mrow"><span id="MJXc-Node-1029" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-1030" class="mjx-texatom" style=""><span id="MJXc-Node-1031" class="mjx-mrow"><span id="MJXc-Node-1032" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1033" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">∼</span></span><span id="MJXc-Node-1034" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.014em;"><span id="MJXc-Node-1035" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span></span><span class="mjx-sub" style="font-size: 80.2%; vertical-align: -0.278em; padding-right: 0.062em;"><span id="MJXc-Node-1036" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-1037" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1038" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1039" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">∣</span></span><span id="MJXc-Node-1040" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1041" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-1042" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1043" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">[</span></span><span id="MJXc-Node-1044" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1045" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1046" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1047" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1048" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1049" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1050" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">]</span></span></span><span id="MJXc-Node-1051" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-1052" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1053" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1054" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-1055" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1056" class="mjx-texatom"><span id="MJXc-Node-1057" class="mjx-mrow"><span id="MJXc-Node-1058" class="mjx-texatom"><span id="MJXc-Node-1059" class="mjx-mrow"><span id="MJXc-Node-1060" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-1061" class="mjx-texatom" style=""><span id="MJXc-Node-1062" class="mjx-mrow"><span id="MJXc-Node-1063" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-1064" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">∼</span></span><span id="MJXc-Node-1065" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-1066" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1067" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-1068" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-1069" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1070" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">[</span></span><span id="MJXc-Node-1071" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1072" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1073" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1074" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1075" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1077" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-1078" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1079" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-1080" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1081" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1082" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1083" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1084" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">]</span></span></span><span id="MJXc-Node-1085" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-1086" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1087" class="mjx-texatom"><span id="MJXc-Node-1088" class="mjx-mrow"><span id="MJXc-Node-1089" class="mjx-texatom"><span id="MJXc-Node-1090" class="mjx-mrow"><span id="MJXc-Node-1091" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.429em; padding-bottom: 0.287em;">E</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.275em; padding-right: 0.071em;"><span id="MJXc-Node-1092" class="mjx-texatom" style=""><span id="MJXc-Node-1093" class="mjx-mrow"><span id="MJXc-Node-1094" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-1095" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">∼</span></span><span id="MJXc-Node-1096" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-1097" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1098" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-1099" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span></span></span><span id="MJXc-Node-1100" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1101" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">[</span></span><span id="MJXc-Node-1102" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1103" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.358em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1104" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-1105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1106" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1107" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1108" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1109" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-1110" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1111" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.5em; padding-bottom: 0.5em;">ϕ</span></span></span></span><span id="MJXc-Node-1112" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1113" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">ϵ</span></span><span id="MJXc-Node-1114" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1115" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1116" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1117" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1118" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.642em; padding-bottom: 0.642em;">]</span></span></span><span id="MJXc-Node-1119" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.358em;">.</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>ϕ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mo>∼</mo><msub><mi>q</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>]</mo></mrow><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>ϕ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>ϵ</mi><mo>∼</mo><mi>p</mi><mo stretchy="false">(</mo><mi>ϵ</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><msub><mi>g</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>ϵ</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>]</mo></mrow><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>ϵ</mi><mo>∼</mo><mi>p</mi><mo stretchy="false">(</mo><mi>ϵ</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo>[</mo><msub><mi mathvariant="normal">∇</mi><mi>ϕ</mi></msub><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><msub><mi>g</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><mi>ϵ</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>]</mo></mrow><mo>.</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-111">\nabla_\phi \E_{z \sim q_\phi(z\mid x)}\left[ f(x,z) \right] = \nabla_\phi \E_{\epsilon \sim p(\epsilon)}\left[ f(x, g_\phi(\epsilon, x)) \right] = \E_{\epsilon \sim p(\epsilon)}\left[ \nabla_\phi f(x, g_\phi(\epsilon, x)) \right].</script>

<p>The gradient is now inside the expectation, so we may take Monte Carlo samples to estimate the right-hand term. This approach has much lower variance<label for="note-reparam" class="margin-toggle sidenote-number"></label><input type="checkbox" id="note-reparam" class="margin-toggle"><span class="sidenote">For more details as to why, have a look at the appendix of the paper by <a href="https://arxiv.org/pdf/1401.4082.pdf">Rezende et al.</a></span> than the score function estimator, and will enable us to learn models that we otherwise couldn’t learn.</p>

<h3 id="choosing-q-and-p">Choosing <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-112-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1120" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1121" class="mjx-mrow"><span id="MJXc-Node-1122" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.211em; padding-bottom: 0.461em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-112">q</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-113-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1123" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1124" class="mjx-mrow"><span id="MJXc-Node-1125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.211em; padding-bottom: 0.461em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-113">p</script></h3>

<p>Until now, we did not specify the exact form of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-114-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1126" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1127" class="mjx-mrow"><span id="MJXc-Node-1128" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">p</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-115-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1129" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1130" class="mjx-mrow"><span id="MJXc-Node-1131" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">q</script>, besides saying that these could be arbitrary functions. How should one parametrize these distributions? The best <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-116-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1132" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1133" class="mjx-mrow"><span id="MJXc-Node-1134" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-1135" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1136" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1137" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-1138" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-1139" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-116">q(z\mid x)</script> should be able to approximate the true posterior <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-117-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1140" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1141" class="mjx-mrow"><span id="MJXc-Node-1142" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-1143" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1144" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1145" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-1146" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-1147" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-117">p(z\mid x)</script>. Similarly, <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-118-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1148" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1149" class="mjx-mrow"><span id="MJXc-Node-1150" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-1151" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1152" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-1153" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-1154" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1155" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-118">p(x\mid z)</script> should be flexible enough to represent the richness of the data.</p>

<p>For these reasons, we are going to parametrize <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-119-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1156" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1157" class="mjx-mrow"><span id="MJXc-Node-1158" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">q</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-120-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1159" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1160" class="mjx-mrow"><span id="MJXc-Node-1161" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">p</script> by <em>neural networks</em>. These are extremely expressive function approximators that can be efficiently optimized over large datasets. This choice also draws a fascinating bridge between classical machine learning methods (approximate Bayesian inference in this case) and modern deep learning.</p>

<p>But what does it mean to parametrize a distribution with a neural network? Let’s assume again that <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-121-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1162" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1163" class="mjx-mrow"><span id="MJXc-Node-1164" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-1165" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1167" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-1168" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-1169" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-121">q(z\mid x)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-122-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1170" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1171" class="mjx-mrow"><span id="MJXc-Node-1172" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span><span id="MJXc-Node-1173" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1174" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-1175" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">∣</span></span><span id="MJXc-Node-1176" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1177" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-122">p(x\mid z)</script> are Normal distributions; we may write them as</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-123-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;diag&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-1178" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1179" class="mjx-mrow"><span id="MJXc-Node-1180" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-1181" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1182" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1183" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">∣</span></span><span id="MJXc-Node-1184" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1185" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1186" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-1187" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-1188" class="mjx-mrow"><span id="MJXc-Node-1189" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.5em; padding-bottom: 0.358em; padding-right: 0.159em;">N</span></span></span></span><span id="MJXc-Node-1190" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1191" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1192" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.145em; padding-bottom: 0.571em;">;</span></span><span id="MJXc-Node-1193" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1194" class="mjx-mrow"><span id="MJXc-Node-1195" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.079em;"><span id="MJXc-Node-1197" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.5em; padding-bottom: 0.287em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1196" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">μ</span></span></span></span></span></span></span><span id="MJXc-Node-1198" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1199" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1200" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1201" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1202" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">diag</span></span><span id="MJXc-Node-1203" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1204" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1205" class="mjx-texatom"><span id="MJXc-Node-1206" class="mjx-mrow"><span id="MJXc-Node-1207" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.062em;"><span id="MJXc-Node-1209" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.5em; padding-bottom: 0.287em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1208" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.001em;">σ</span></span></span></span></span></span></span><span id="MJXc-Node-1210" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1211" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1212" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1213" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1214" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1215" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.358em; padding-bottom: 0.358em;">2</span></span></span></span><span id="MJXc-Node-1216" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo>;</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>μ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>diag</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>σ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-123">q(z\mid x) = \mathcal{N}(z; \vec\mu(x), \diag(\vec\sigma(x))^2)</script>

<p>where <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-124-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1217" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1218" class="mjx-mrow"><span id="MJXc-Node-1219" class="mjx-texatom"><span id="MJXc-Node-1220" class="mjx-mrow"><span id="MJXc-Node-1221" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.079em;"><span id="MJXc-Node-1223" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.509em; padding-bottom: 0.256em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1222" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.509em;">μ</span></span></span></span></span></span></span><span id="MJXc-Node-1224" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1225" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-1226" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span><span id="MJXc-Node-1227" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-1228" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1229" class="mjx-mrow"><span id="MJXc-Node-1230" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.062em;"><span id="MJXc-Node-1232" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.509em; padding-bottom: 0.256em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1231" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.001em;">σ</span></span></span></span></span></span></span><span id="MJXc-Node-1233" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1234" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span><span id="MJXc-Node-1235" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>μ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>σ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-124">\vec\mu(x), \vec\sigma(x)</script> are deterministic vector-valued functions of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-125-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1236" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1237" class="mjx-mrow"><span id="MJXc-Node-1238" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">x</script> parametrized by an arbitrary complex neural network.</p>

<p>More generally, the same technique can be applied to any exponential family distribution by parameterizing the sufficient statistics by a function of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-126-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1239" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1240" class="mjx-mrow"><span id="MJXc-Node-1241" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-126">x</script>.</p>

<h2 id="the-variational-auto-encoder">The variational auto-encoder</h2>

<p>We are now ready to define the AEVB algorithm and the variational autoencoder, its most popular instantiation.</p>

<p>The AEVB algorithm is simply the combination of (1) the auto-encoding ELBO reformulation, (2) the black-box variational inference approach, and (3) the reparametrization-based low-variance gradient estimator. It optimizes the auto-encoding ELBO using black-box variational inference with the reparametrized gradient estimator. This algorithm is applicable to any deep generative model <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-127-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1242" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1243" class="mjx-mrow"><span id="MJXc-Node-1244" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1245" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-1246" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">θ</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-127">p_\theta</script> with latent variables that is differentiable in <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-128-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1247" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1248" class="mjx-mrow"><span id="MJXc-Node-1249" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.458em; padding-bottom: 0.306em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-128">\theta</script>.</p>

<p>A variational auto-encoder uses the AEVB algorithm to learn a specific model <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-129-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1250" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1251" class="mjx-mrow"><span id="MJXc-Node-1252" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-129">p</script> using a particular encoder <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-130-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1253" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1254" class="mjx-mrow"><span id="MJXc-Node-1255" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-130">q</script>. The model <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-131-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1256" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1257" class="mjx-mrow"><span id="MJXc-Node-1258" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">p</script> is parametrized as</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-132-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;diag&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-1259" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1260" class="mjx-mrow"><span id="MJXc-Node-1261" class="mjx-mtable" style="vertical-align: -1.033em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1262" class="mjx-mtr" style="height: 1.327em;"><span id="MJXc-Node-1263" class="mjx-mtd" style="padding: 0px; text-align: right; width: 3.155em;"><span id="MJXc-Node-1264" class="mjx-mrow" style="margin-top: -0.098em;"><span id="MJXc-Node-1265" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-1266" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1268" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">∣</span></span><span id="MJXc-Node-1269" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1271" class="mjx-mtd" style="padding: 0px; text-align: left; width: 11.22em;"><span id="MJXc-Node-1272" class="mjx-mrow" style="margin-top: -0.098em;"><span id="MJXc-Node-1273" class="mjx-mi"></span><span id="MJXc-Node-1274" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-1275" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-1276" class="mjx-mrow"><span id="MJXc-Node-1277" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.5em; padding-bottom: 0.358em; padding-right: 0.159em;">N</span></span></span></span><span id="MJXc-Node-1278" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1279" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1280" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.145em; padding-bottom: 0.571em;">;</span></span><span id="MJXc-Node-1281" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1282" class="mjx-mrow"><span id="MJXc-Node-1283" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.079em;"><span id="MJXc-Node-1285" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.5em; padding-bottom: 0.287em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1284" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">μ</span></span></span></span></span></span></span><span id="MJXc-Node-1286" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1287" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1288" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1289" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1290" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">diag</span></span><span id="MJXc-Node-1291" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1292" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1293" class="mjx-texatom"><span id="MJXc-Node-1294" class="mjx-mrow"><span id="MJXc-Node-1295" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.062em;"><span id="MJXc-Node-1297" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.5em; padding-bottom: 0.287em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1296" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.001em;">σ</span></span></span></span></span></span></span><span id="MJXc-Node-1298" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1299" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1300" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1301" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1302" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1303" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.358em; padding-bottom: 0.358em;">2</span></span></span></span><span id="MJXc-Node-1304" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1305" class="mjx-mtr" style="height: 1.239em;"><span id="MJXc-Node-1306" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-1307" class="mjx-mrow" style="margin-top: -0.186em;"><span id="MJXc-Node-1308" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">p</span></span><span id="MJXc-Node-1309" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1310" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1311" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1312" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-1313" class="mjx-mrow" style="margin-top: -0.186em;"><span id="MJXc-Node-1314" class="mjx-mi"></span><span id="MJXc-Node-1315" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-1316" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-1317" class="mjx-mrow"><span id="MJXc-Node-1318" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.5em; padding-bottom: 0.358em; padding-right: 0.159em;">N</span></span></span></span><span id="MJXc-Node-1319" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1320" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1321" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.145em; padding-bottom: 0.571em;">;</span></span><span id="MJXc-Node-1322" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.358em; padding-bottom: 0.358em;">0</span></span><span id="MJXc-Node-1323" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1324" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.429em; padding-bottom: 0.287em; padding-right: 0.064em;">I</span></span><span id="MJXc-Node-1325" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1326" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∣</mo><mi>z</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo>;</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>μ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>,</mo><mi>diag</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>σ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo>;</mo><mn>0</mn><mo>,</mo><mi>I</mi><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-132">% <![CDATA[
\begin{align*}
p(x\mid z) & = \mathcal{N}(x; \vec\mu(z), \diag(\vec\sigma(z))^2) \\
p(z) & = \mathcal{N}(z; 0, I),
\end{align*} %]]></script>

<p>where <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-133-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1327" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1328" class="mjx-mrow"><span id="MJXc-Node-1329" class="mjx-texatom"><span id="MJXc-Node-1330" class="mjx-mrow"><span id="MJXc-Node-1331" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.079em;"><span id="MJXc-Node-1333" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.509em; padding-bottom: 0.256em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1332" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.509em;">μ</span></span></span></span></span></span></span><span id="MJXc-Node-1334" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1335" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1336" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span><span id="MJXc-Node-1337" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.149em; padding-bottom: 0.56em;">,</span></span><span id="MJXc-Node-1338" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1339" class="mjx-mrow"><span id="MJXc-Node-1340" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.062em;"><span id="MJXc-Node-1342" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.509em; padding-bottom: 0.256em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1341" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.001em;">σ</span></span></span></span></span></span></span><span id="MJXc-Node-1343" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">(</span></span><span id="MJXc-Node-1344" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1345" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.458em; padding-bottom: 0.61em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>μ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>σ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-133">\vec\mu(z), \vec\sigma(z)</script> are parametrized by a neural network (typically, two dense hidden layers of 500 units each). The model <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-134-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1346" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1347" class="mjx-mrow"><span id="MJXc-Node-1348" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-134">q</script> is similarly parametrized as</p>

<span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-135-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;diag&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; text-align: center; position: relative;"><span id="MJXc-Node-1349" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1350" class="mjx-mrow"><span id="MJXc-Node-1351" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-1352" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1354" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">∣</span></span><span id="MJXc-Node-1355" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1356" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1357" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.074em; padding-bottom: 0.287em;">=</span></span><span id="MJXc-Node-1358" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-1359" class="mjx-mrow"><span id="MJXc-Node-1360" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.5em; padding-bottom: 0.358em; padding-right: 0.159em;">N</span></span></span></span><span id="MJXc-Node-1361" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1362" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1363" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.145em; padding-bottom: 0.571em;">;</span></span><span id="MJXc-Node-1364" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1365" class="mjx-mrow"><span id="MJXc-Node-1366" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.079em;"><span id="MJXc-Node-1368" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.5em; padding-bottom: 0.287em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1367" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.5em;">μ</span></span></span></span></span></span></span><span id="MJXc-Node-1369" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1370" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1371" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1372" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.571em;">,</span></span><span id="MJXc-Node-1373" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.429em; padding-bottom: 0.571em;">diag</span></span><span id="MJXc-Node-1374" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1375" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1376" class="mjx-texatom"><span id="MJXc-Node-1377" class="mjx-mrow"><span id="MJXc-Node-1378" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.248em; padding-bottom: 0.06em; padding-left: 0.062em;"><span id="MJXc-Node-1380" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-vec-R" style="padding-top: 0.5em; padding-bottom: 0.287em;">→</span></span></span><span class="mjx-op"><span id="MJXc-Node-1379" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em; padding-right: 0.001em;">σ</span></span></span></span></span></span></span><span id="MJXc-Node-1381" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">(</span></span><span id="MJXc-Node-1382" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.216em; padding-bottom: 0.287em;">x</span></span><span id="MJXc-Node-1383" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1384" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1385" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1386" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.358em; padding-bottom: 0.358em;">2</span></span></span></span><span id="MJXc-Node-1387" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.5em; padding-bottom: 0.571em;">)</span></span><span id="MJXc-Node-1388" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.138em; padding-bottom: 0.358em;">.</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo>;</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>μ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>diag</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>σ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo><mo>.</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-135">q(z\mid x) = \mathcal{N}(z; \vec\mu(x), \diag(\vec\sigma(x))^2).</script>

<p>This choice of <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-136-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1389" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1390" class="mjx-mrow"><span id="MJXc-Node-1391" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">p</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-137-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1392" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1393" class="mjx-mrow"><span id="MJXc-Node-1394" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.458em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-137">q</script> allows us to further simplify the auto-encoding ELBO. In particular, we can use a closed form expression to compute the regularization term, and we only use Monte-Carlo estimates for the reconstruction term. These expressions are given in the paper.</p>

<p>We may interpret the variational autoencoder as a directed latent-variable probabilistic graphical model. We may also view it as a particular objective for training an auto-encoder neural network; unlike previous approaches, this objective derives reconstruction and regularization terms from a more principled, Bayesian perspective.</p>

<h3 id="experimental-results">Experimental results</h3>

<p><label for="mnist" class="margin-toggle">⊕</label>
<input type="checkbox" id="mnist" class="margin-toggle">
<span class="marginnote"><img class="fullwidth" src="./The variational auto-encoder_files/mnist.png" alt="Interpolating over MNIST digits by interpolating over latent variables"><br>
    Interpolating over MNIST digits by interpolating over latent variables
</span>
The VAE can be applied to images <span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-138-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 94%; position: relative;"><span id="MJXc-Node-1395" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1396" class="mjx-mrow"><span id="MJXc-Node-1397" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.205em; padding-bottom: 0.306em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">x</script> in order to learn interesting latent representations. The VAE paper contains a few examples on the Frey face dataset and on the MNIST digits. On the face dataset, we can interpolate between facial expressions by interpolating between latent variables (e.g. we can generate smooth transitions between “angry” and “surprised”). On the MNIST dataset, we can similarly interpolate between numbers.</p>

<p>The authors also compare their methods against three alternative approaches: the wake-sleep algorithm, Monte-Carlo EM, and hybrid Monte-Carlo. The latter two methods are sampling-based approaches; they are quite accurate, but don’t scale well to large datasets. Wake-sleep is a variational inference algorithm that scales much better; however it does not use the exact gradient of the ELBO (it uses an approximation), and hence it is not as accurate as AEVB. The paper illustrates this by plotting learning curves.</p>

<p><br></p>

<table>
  <tbody>
    <tr>
      <td><a href="https://ermongroup.github.io/cs228-notes/">Index</a></td>
      <td><a href="https://ermongroup.github.io/cs228-notes/learning/structure">Previous</a></td>
      <td><a href="https://ermongroup.github.io/cs228-notes/extras/vae/">Next</a></td>
    </tr>
  </tbody>
</table>


    </article>
    <footer>
<hr class="slender">
<div class="credits">
Site created with <a href="https://jekyllrb.com/">Jekyll</a> using the <a href="https://github.com/clayh53/tufte-jekyll">Tufte theme</a>. © 2020
</div>
</footer>

  

</body></html>